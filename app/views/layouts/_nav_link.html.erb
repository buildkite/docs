<%
  css_classes_nav_link = "
    Nav__link
    Nav__link--level#{nav_level}
    #{"Nav__link--type-#{type}" if type}
  "
%>

<% if path %>
  <%
    title = "Go to #{name}"
    if type == "link"
      title = "Shortcut link to '#{name}' under the #{top_level_nav_item_name(path)} section"
    end
  %>
  <a
    class="<%= css_classes_nav_link %> <%= 'Nav__link--current' if current_path == nav_path(path) %>"
    href="<%= nav_path(path) %>"
    title="<%= title %>"
    <%= new_window && 'target=_blank' %>
  >
    <%= name %>
    
    <% if pill %>
      <span class="Nav__pill pill pill--<%= pill %> pill--small"><%= pill %></span>
    <% end %>

    <% if type == "link" %>
      <%= image_tag "icons/external_link", alt: "Icon: shortcut link", height: "16", width: "16" %>
    <% end %>
  </a>
<% elsif start_expanded %>
  <span class="<%= css_classes_nav_link %> Nav__link--pre-expand-children">
    <%= name %>
    <% if pill %>
      <span class="Nav__pill pill pill--<%= pill %> pill--small"><%= pill %></span>
    <% end %>
  </span>
<% else %>
  <button 
    class="<%= css_classes_nav_link %> <%= type == "dropdown" ? 'Nav__dropdown-toggle' : 'Nav__toggle' %>"
    data-toggle-nav-level="<%= nav_level %>"
  >
    <%= name %>
    <% if pill %>
      <span class="Nav__pill pill pill--<%= pill %> pill--small"><%= pill %></span>
    <% end %>
  </button> 
<% end %>
