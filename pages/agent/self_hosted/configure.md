# Buildkite Agent configuration

Every agent installer comes with a configuration file. You can also customize many of the configuration values using environment variables.


## Example configuration file

```sh
token="24db61df8338027652b24aadf82dd483b016eef98fcd332815"
name="my-app-%spawn"
tags="ci=true,docker=true"
git-clean-flags="-ffdqx"
debug=true
```
{: codeblock-file="/buildkite/buildkite-agent.cfg"}

You can find the directory location of your configuration file in your platform's installation documentation. You can also set this folder using the `--config` command line argument or the `BUILDKITE_AGENT_CONFIG` environment variable.

```sh
BUILDKITE_AGENT_CONFIG="/etc/buildkite-agent/custom-config-files-dir" buildkite-agent start
```

## Configuration settings
<!-- vale off -->

<!--
The items in the below attributes table are sourced from the data/content/agent_attributes.yaml file.
This yaml file is auto-generated by scripts/update-agent-configuration.sh, please update the
agent CLI help in https://github.com/buildkite/agent and run the generation script.
-->

<table class="Docs__attribute__table">
  <colgroup>
    <col>
    <col>
  </colgroup>
  <tbody>
    <tr class="importance required"><th>Required</th></tr>
    <% AGENT_ATTRIBUTES['attributes'].each do |attr| -%>
      <% if attr['required'] %>
        <tr id="<%= attr['name'] %>">
          <th>
            <code><%= attr['name'] %><a class="Docs__attribute__link" href="#<%= attr['name'] %>">#</a></code>
            <span class="Docs__attribute__importance"><%= attr['required'] ? "Required" : "Optional" -%></span>
            <p class="Docs__attribute__env-var">
              <strong>Environment variable: </strong>
              <br/>
              <code><%= attr['env_var'] %></code>
            </p>
            <% if attr['default_value'] && !attr['default_value'].strip.empty? %>
            <p class="Docs__attribute__default">
              <strong>Default value: </strong>
              <code><%= attr['default_value'] %></code>
            </p>
            <% end %>
          </th>
          <td>
            <%= render_markdown(text: attr['desc']) -%>
          </td>
        </tr>
      <% end -%>
    <% end -%>
    <tr class="importance optional"><th>Optional</th></tr>
    <% AGENT_ATTRIBUTES['attributes'].each do |attr| -%>
      <% if !attr['required'] %>
        <tr id="<%= attr['name'] %>">
          <th>
            <code><%= attr['name'] %><a class="Docs__attribute__link" href="#<%= attr['name'] %>">#</a></code>
            <span class="Docs__attribute__importance"><%= attr['required'] ? "<strong>Required</strong>" : "Optional" -%></span>
            <p class="Docs__attribute__env-var">
              <strong>Environment variable: </strong>
              <br/>
              <code><%= attr['env_var'] %></code>
            </p>
            <% if attr['default_value'] && !attr['default_value'].strip.empty? %>
            <p class="Docs__attribute__default">
              <strong>Default value: </strong>
              <code><%= attr['default_value'] %></code>
            </p>
            <% end %>
          </th>
          <td>
            <% if attr['experimental'] %>
              <%= render_markdown(text: ">ðŸ›  Experimental feature") -%>
            <% end -%>

            <%= render_markdown(text: attr['desc']) -%>
          </td>
        </tr>
      <% end -%>
    <% end -%>
  </tbody>
</table>
<!-- vale on -->

### Experimental features

Buildkite frequently introduces new experimental features to the agent, which can be enabled using the [`experiment` flag or the `$BUILDKITE_AGENT_EXPERIMENT` environment variable setting](#experiment). These features are not yet considered stable and may change or be removed in future versions of the agent. Learn more about these experimental features in [Agent experiments](/docs/agent/self-hosted/configure/experiments).

## Deprecated configuration settings

<table>
  <tbody>
    <tr id="disconnect-after-job-timeout">
      <th><code>disconnect-after-job-timeout</code></th>
      <td>
        <p>When <code>disconnect-after-job</code> is specified, the number of seconds to wait for a job before shutting down.</p>
        <p>Not to be confused with <a href="/docs/pipelines/configure/build-timeouts#command-timeouts">default and maximum build timeouts</a>.</p>
        <p class="Docs__api-param-eg"><em>Default:</em> <code>120</code></p>
        <p class="Docs__api-param-eg"><em>Environment variable:</em> <code>BUILDKITE_AGENT_DISCONNECT_AFTER_JOB_TIMEOUT</code></p>
      </td>
    </tr>

    <tr id="meta-data">
      <th><code>meta-data</code></th>
      <td>
        Meta data for the agent.
        <p class="Docs__api-param-eg"><em>Default:</em> <code>"queue=default"</code></p>
        <p class="Docs__api-param-eg"><em>Environment variable:</em> <code>BUILDKITE_AGENT_META_DATA</code></p>
        <p class="Docs__api-param-eg"><a href="#tags"><em>Use instead:</em> <code>tags</code></a></p>
      </td>
    </tr>

    <tr id="meta-data-ec2">
      <th><code>meta-data-ec2</code></th>
      <td>
        Include the host's EC2 meta-data (instance-id, instance-type, and ami-id) as meta-data.
        <p class="Docs__api-param-eg"><em>Default:</em> <code>false</code></p>
        <p class="Docs__api-param-eg"><em>Environment variable:</em> <code>BUILDKITE_AGENT_META_DATA_EC2</code></p>
        <p class="Docs__api-param-eg"><a href="#tags-from-ec2"><em>Use instead:</em> <code>tags-from-ec2</code></a></p>
      </td>
    </tr>

    <tr id="meta-data-ec2-tags">
      <th><code>meta-data-ec2-tags</code></th>
      <td>
        Include the host's EC2 tags as meta-data.
        <p class="Docs__api-param-eg"><em>Default:</em> <code>false</code></p>
        <p class="Docs__api-param-eg"><em>Environment variable:</em> <code>BUILDKITE_AGENT_META_DATA_EC2_TAGS</code></p>
        <p class="Docs__api-param-eg"><a href="#tags-from-ec2-tags"><em>Use instead:</em> <code>tags-from-ec2-tags</code></a></p>
      </td>
    </tr>

    <tr id="meta-data-gcp">
      <th><code>meta-data-gcp</code></th>
      <td>
        Include the host's GCP meta-data as meta-data.
        <p class="Docs__api-param-eg"><em>Default:</em> <code>false</code></p>
        <p class="Docs__api-param-eg"><em>Environment variable:</em> <code>BUILDKITE_AGENT_META_DATA_GCP_TAGS</code></p>
        <p class="Docs__api-param-eg"><a href="#tags-from-gcp"><em>Use instead:</em> <code>tags-from-gcp</code></a></p>
      </td>
    </tr>

    <tr id="no-automatic-ssh-fingerprint-verification">
      <th><code>no-automatic-ssh-fingerprint-verification</code></th>
      <td>
        Do not automatically verify SSH fingerprints for first-time checkouts.
        <p class="Docs__api-param-eg"><em>Default:</em> <code>false</code></p>
        <p class="Docs__api-param-eg"><em>Environment variable:</em> <code>BUILDKITE_NO_AUTOMATIC_SSH_FINGERPRINT_VERIFICATION</code></p>
        <p class="Docs__api-param-eg"><a href="#no-ssh-keyscan"><em>Use instead:</em> <code>no-ssh-keyscan</code></a></p>
      </td>
    </tr>
  </tbody>
</table>

## Environment variables

Most configuration options can be specified as environment variables when starting the agent, for example:

```sh
BUILDKITE_AGENT_TAGS="queue=deploy,host=$(hostname)" buildkite-agent start
```

These variables cannot be modified through the Buildkite web interface, API or using pipeline upload for security reasons. You may be able to modify some of the options, such as `BUILDKITE_GIT_CLONE_FLAGS`, from within [hooks](/docs/agent/hooks).

## Agent Naming

The following template variables are supported when configuring the agent name:

- `%hostname` - the agent machine's hostname
- `%spawn` - the spawn index number (1, 2, 3, etc.) when launching multiple agents per host
- `%random` - six (6) random alphanumeric characters [a-zA-Z0-9]
- `%pid` - the agent's process ID

> ðŸ“˜ Note
> If you're using `--spawn` to run multiple agents on a single host, it's recommended to use `%spawn` in your agent name to ensure that each agent running on the host using the same `build-path` has a unique agent name.
